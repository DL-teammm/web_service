# Веб-сервис для проекта "Распознавание дорожных знаков"

## Введение

В этом репозитории реализован стенд на Streamlit для демонстрации работы нашего подхода. На текущий момент добавлен вариант пайплайна с использованием только детекционной модели YOLOv8 с несколькими классами дорожных знаков.

## Окружение

Необходимые библиотеки зафиксированы в файле ```requirements.txt```. Необходимо создать новое виртуальное окружение, активировать его и установить в него необходимые пакеты командой:

```pip install -r requirements.txt```

## Как работает веб-сервис?

1. В папке ```test_clips``` лежат видеоклипы для тестирования. Для создания нового тестового видео добавьте это видео в папку ```test_clips```.

2. Сначала на боковой панели пользователь должен выбрать:

    - тестовый видеоклип из списка возможных (в этом списке содержатся все видео из папки ```test_clips```)
    - что использовать при инференсе модели: cpu или cuda

3. Информация об используемой модели берётся из папки ```./model_info/```. Здесь должны лежать следующие файлы:

    - pt-веса обученной модели YOLOv8
    - файл ```class_labels.yaml``` с информацией об именах классов (используется при отрисовке результатов)

4. После совершённого выбора на основной странице веб-сервиса в процессе обработки видео на каждом 20-ом кадре будут печататься логи, которые содержат информацию о том, сколько дорожных знаков было обнаружено на данном кадре, какое в среднем FPS было у детекционной модели на последних кадрах.

5. После завершения обработки тестового клипа будут сохранены следующие результаты:  

    - видео с отрисовкой детекций в папке: ```./results/videos/```
    - текстовый файл с логами запуска обработки в папке: ```./results/logs/```

6. Видео с отрисовкой результатов также будет отображаться на основной странице веб-сервиса.

## Запуск стенда

После создания необходимого окружения для запуска стенда воспользуйтесь командой:

```streamlit run app.py```